<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>TrigguiApp â€“ Un instante, un universo</title>
  <link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;700&family=Poppins:wght@500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --header-height: 60px;
      --footer-height: 120px;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    html,body {
      width:100%; height:100%;
      font-family:'Archivo',sans-serif;
      background:radial-gradient(circle at 30% 30%, #0f0c29, #302b63, #24243e);
      overflow:hidden;
    }
    body.dark {
      background: radial-gradient(circle, #000000 0%, #1c1c1c 100%);
    }
    .main {
      display:flex; flex-direction:column; height:100dvh;
      opacity:0; animation:fadeIn 1.5s ease forwards;
    }
    .header-message {
      height:var(--header-height);
      display:flex; align-items:center; justify-content:center;
      padding:0 2vw;
    }
    .header-gradient {
      font-weight:900;
      font-size:clamp(1.3rem,2.5vw,2rem);
      background:linear-gradient(to right,#ff00f7,#00ffe7,#ffe600,#ff006e,#00c3ff);
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-size:300% 300%;
      animation:glowtext 8s linear infinite;
    }
    .grid {
      flex:1;
      display:grid;
      gap:1.5vw;
      padding:0 2vw;
      grid-template-columns:1fr 1fr;
      grid-template-rows:1fr 1fr;
    }
    @media (orientation: landscape) {
      .grid { grid-template-columns: repeat(4, 1fr); grid-template-rows: 1fr; }
    }
    .block {
      position:relative;
      display:flex; justify-content:center; align-items:center;
      text-align:center;
      border-radius:20px;
      font-weight:bold;
      font-size:clamp(1rem,2vw,1.4rem);
      color:#ffffff;
      background-size:250% 250%;
      background-position:center;
      cursor:pointer;
      transition:transform .5s ease;
      overflow:hidden;
      transform:scale(.94);
      opacity:0;
      animation:scaleFadeIn 1.2s forwards;
      padding:10px;
      box-shadow:0 0 32px rgba(255,255,255,0.08);
    }
    .block:hover {
      transform:scale(1.02);
      box-shadow:0 0 50px rgba(255,255,255,0.2);
    }
    .block-content {
      position:absolute;
      inset:0;
      display:flex;
      justify-content:center;
      align-items:center;
      padding:10px;
      text-align:center;
    }
    .label {
      z-index:2;
      font-weight:900;
      text-shadow: 0 0 10px rgba(0,0,0,0.6);
    }
    .accionable {
      font-family:'Poppins',sans-serif;
      font-size:clamp(.9rem,1.4vw,1.2rem);
      font-weight:600;
      padding:10px 16px;
      border-radius:18px;
      opacity:0;
      animation:aparecer .7s forwards;
      text-align:center;
      box-shadow:0 10px 35px rgba(0,0,0,0.5);
      background:rgba(0,0,0,0.4);
      backdrop-filter: blur(8px);
      z-index:3;
    }
    .portada-wrapper {
      width:100%; height:100%;
      display:flex; justify-content:center; align-items:center;
      background:radial-gradient(circle,#ffffff10,#0000);
      animation:glow 6s ease-in-out infinite;
    }
    .portada-wrapper img {
      width:80%;
      max-height:90%;
      object-fit:contain;
      border-radius:20px;
      box-shadow:0 20px 35px rgba(0,0,0,.6);
      transition:transform .6s ease;
    }
    .portada-wrapper img:hover {
      transform:scale(1.05) rotateY(6deg) rotateX(3deg);
    }
    .footer {
      height:var(--footer-height);
      display:flex; flex-direction:column;
      align-items:center; justify-content:flex-start;
      padding:2.5vh 2vw 2vh;
    }
    .shock {
      background:linear-gradient(135deg,#ff00cc,#ff9900,#00f2fe);
      color:#fff;
      font-weight:bold;
      border:none;
      border-radius:30px;
      padding:12px 26px;
      margin-top:8px;
      font-size:clamp(1rem,2vw,1.3rem);
      cursor:pointer;
      box-shadow:0 0 30px rgba(255,255,255,.3);
      animation:pulse 2s infinite;
    }
    .counter {
      font-size:clamp(1rem,1.3vw,1.1rem);
      color:#fff;
      margin-top:6px;
      font-family:'Poppins',sans-serif;
      text-align:center;
      white-space:nowrap;
      opacity:0;
      animation:fadeInInstant .4s forwards;
    }
    .resaltado {
      font-size:1.2em;
      color:#00f7ff;
      font-weight:800;
    }
    .trigguiletras {
      height:22px;
      opacity:.95;
      margin-top:1.5vh;
    }
    .hidden { display:none!important; }
    .frase-magica {
      font-size:1rem;
      color:#ffe600;
      text-align:center;
      margin-top:1rem;
      font-family:'Poppins',sans-serif;
      animation:fadeIn 1.4s ease;
    }

    @keyframes fadeIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
    @keyframes fadeInInstant{to{opacity:1}}
    @keyframes scaleFadeIn{to{transform:scale(1);opacity:1}}
    @keyframes aparecer{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.08)}}
    @keyframes glow{0%{background:radial-gradient(circle,#ffffff05,#0000)}50%{background:radial-gradient(circle,#ffffff20,#0000)}100%{background:radial-gradient(circle,#ffffff05,#0000)}}
    @keyframes glowtext { 
      0% {background-position: 0% 50%;}
      50% {background-position: 100% 50%;}
      100% {background-position: 0% 50%;}
    }
  </style>
</head>
<body>
  <div class="main">
    <div class="header-message"><div class="header-gradient">Â¿DÃ³nde estÃ¡ el libro? ðŸ“š</div></div>
    <div class="grid" id="gridContainer"></div>
    <div class="footer">
      <div class="frase-magica hidden" id="fraseMagica">âœ¨ Este libro te eligiÃ³ a ti. No es coincidencia.</div>
      <button class="shock hidden" id="shockBtn">ðŸ“– Â¡ChÃ³calas si abriste un libro fÃ­sico!</button>
      <div class="counter hidden" id="contador">âœ¨ Juntos hemos abierto <span class="resaltado">...</span> libros fÃ­sicos âœ¨</div>
      <img src="/trigguiletras.png" class="trigguiletras" id="logoTriggui">
    </div>
  </div>
  <script>
    const $ = id => document.getElementById(id);
    let libroActual, bloquePortada, revelado = false;
    const emojis = ["ðŸŒŠ","ðŸ›¡ï¸","ðŸ§ ","ðŸ“ˆ","ðŸ“˜","ðŸ”®","â¤ï¸","âœ¨","ðŸªž"];

    fetch("https://raw.githubusercontent.com/badirnakid/triggui-content/main/contenido.json")
      .then(res => res.json())
      .then(data => {
        const libro = data.libros[Math.floor(Math.random()*data.libros.length)];
        libroActual = libro;
        bloquePortada = Math.floor(Math.random()*4);
        iniciarUI(libro);
      });

    function generarGradiente(color) {
      const h = parseInt(color.slice(1,3),16),
            l = parseInt(color.slice(3,5),16),
            s = parseInt(color.slice(5,7),16);
      const bright = `rgba(${Math.min(h+60,255)},${Math.min(l+60,255)},${Math.min(s+60,255)},0.9)`;
      return `linear-gradient(145deg, ${color}, ${bright})`;
    }

    function iniciarUI(libro) {
      const grid = $("gridContainer");
      $("logoTriggui").classList.remove("hidden");
      grid.innerHTML = "";
      libro.palabras.forEach((palabra, i) => {
        const div = document.createElement("div");
        div.className = "block";
        div.id = `bloque${i}`;
        div.style.background = generarGradiente(libro.colores[i] || "#555");
        const emoji = emojis[i % emojis.length];
        div.innerHTML = `
          <div class="block-content label">${emoji} ${palabra}</div>
          <div class="block-content accionable hidden" id="bloque${i}Text">${libro.frases[i]}</div>`;
        div.onclick = () => manejarClick(i);
        grid.appendChild(div);
      });
    }

    function manejarClick(i) {
      if (revelado) return location.reload();
      if (i === bloquePortada) revelarTodo();
      else {
        $(`bloque${i}Text`).classList.remove("hidden");
        $(`bloque${i}`).querySelector(".label").classList.add("hidden");
      }
    }

    function revelarTodo() {
      libroActual.palabras.forEach((_, i) => {
        const block = $(`bloque${i}`);
        if (i === bloquePortada) {
          block.innerHTML = "";
          const wrapper = document.createElement("div");
          wrapper.className = "portada-wrapper";
          const img = document.createElement("img");
          img.src = libroActual.portada;
          img.alt = "Portada";
          wrapper.appendChild(img);
          block.appendChild(wrapper);
          block.style.background = "none";
        } else {
          $(`bloque${i}Text`).classList.remove("hidden");
          block.querySelector(".label").classList.add("hidden");
        }
      });
      document.body.classList.add("dark");
      document.body.style.background = libroActual.fondo;
      $("logoTriggui").classList.add("hidden");
      $("fraseMagica").classList.remove("hidden");
      setTimeout(() => {
        $("fraseMagica").classList.add("hidden");
        $("shockBtn").classList.remove("hidden");
      }, 2500);
      revelado = true;
    }

    $("shockBtn").onclick = async () => {
      $("shockBtn").classList.add("hidden");
      $("contador").classList.remove("hidden");
      try {
        const res = await fetch("https://triggui-api.vercel.app/api/increment");
        const data = await res.json();
        $("contador").innerHTML = `âœ¨ Juntos hemos abierto <span class="resaltado">${data.total.toLocaleString('es-MX')}</span> libros fÃ­sicos âœ¨`;
      } catch {
        $("contador").innerText = "ðŸ“š Â¡Error al contar libros!";
      }
    };
  </script>
</body>
</html>
