<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>Triggui · prueba</title>
<link href="https://fonts.googleapis.com/css2?family=Archivo:wght@400;700&family=Poppins:wght@500;800&display=swap" rel="stylesheet"/>
<style>
*,*:before,*:after{margin:0;padding:0;box-sizing:border-box}
html,body{height:100%;font-family:'Archivo',sans-serif;background:#0e0f1b;color:#fff;overflow:hidden}
#error{position:fixed;top:6px;left:50%;transform:translateX(-50%);background:#e84747;padding:.4rem 1rem;font-family:'Poppins';font-size:.8rem;border-radius:8px;display:none;z-index:99}
.intro{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);padding:1.6rem 2.6rem;background:#12162a;border-radius:24px;box-shadow:0 0 14px rgba(48,255,228,.32);font-family:'Poppins';font-size:1rem;animation:fade 2s 1s forwards}
.intro .hl{color:#30ffe4;font-weight:800}
@keyframes fade{to{opacity:0;visibility:hidden;transform:translate(-50%,-72%)}}
.grid{position:absolute;inset:5vh 1.5vw;display:grid;gap:1vw}
@media(orientation:landscape){.grid{grid-template-columns:repeat(4,1fr)}}
@media(orientation:portrait){.grid{grid-template-columns:repeat(2,1fr);grid-template-rows:repeat(2,1fr)}}
.block{border-radius:22px;display:flex;align-items:center;justify-content:center;text-align:center;font-weight:700;letter-spacing:.3px;cursor:pointer;overflow:hidden;box-shadow:0 10px 26px rgba(0,0,0,.46);background-size:350% 350%;transition:background-position 4s}
.block:hover{background-position:100% 100%}
.label{padding:1rem}
.frase,.portada{position:absolute;inset:0;display:none;align-items:center;justify-content:center;padding:1rem;font-family:'Poppins';text-align:center}
.portada img{max-width:88%;border-radius:18px;box-shadow:0 12px 32px rgba(0,0,0,.55)}
.port-text h2{font-size:clamp(1.9rem,5vw,3.3rem);font-weight:800}
.port-text p{font-size:clamp(.9rem,1.8vw,1.2rem)}
.cta{position:fixed;bottom:3vh;left:50%;transform:translateX(-50%);display:none;gap:1rem}
.cta button{border:none;padding:.6rem 1.1rem;border-radius:999px;font-size:.9rem;font-weight:700;cursor:pointer}
#otro{background:#ffd3d3;color:#000}
#fisico{background:#d3ffd8;color:#000}
</style>
</head>
<body>

<div id="error"></div>
<div class="intro"><span class="hl">Elige una palabra.</span> Detente un segundo.</div>
<div class="grid" id="grid"></div>
<div class="cta"  id="cta">
  <button id="otro">otro</button>
  <button id="fisico">abrí</button>
</div>

<script>
const grid=document.getElementById("grid"),errBox=document.getElementById("error");
let libro;
const dummy={
  titulo:"Demo",
  autor:"Triggui",
  palabras:["Mover","Sentir","Pensar"],
  frases:["🚶 Muévete un poco.","❤️ Nota tu pulso.","🧠 Piensa en claro."],
  colores:["#ff9a9e","#ffb473","#a18cd1","#fbc2eb"],
  textColors:["#000","#000","#000","#000"],
  portada:"📚 Demo\nTriggui"
};
const isURL=s=>/^https?:\/\//i.test(s||"");

const grad=(c1,c2)=>`linear-gradient(135deg,${c1},${c2})`;
function makePort(p){
  const d=document.createElement("div");d.className="portada";
  if(isURL(p)){const img=new Image();img.src=p;d.append(img);}
  else{
    const box=document.createElement("div");box.className="port-text";
    const [t,...rest]=p.split("\\n");
    box.innerHTML=`<h2>${t}</h2><p>${rest.join(" ")}</p>`;d.append(box);
  }
  return d;
}
function render(){
  grid.innerHTML="";
  const cols=libro.colores.length<4?[...libro.colores,...Array(4-libro.colores.length).fill("#ffffff")]:libro.colores;
  for(let i=0;i<4;i++){
    const b=document.createElement("div");
    b.className="block";b.dataset.i=i;
    b.style.background=grad(cols[i],cols[(i+1)%4]);
    const lab=document.createElement("div");lab.className="label";
    const fr=document.createElement("div");fr.className="frase";
    if(i<3){
      lab.textContent=`${["🚶","❤️","🧠"][i]} ${libro.palabras[i]}`;
      fr.textContent=libro.frases[i];
    }else lab.textContent="📚 Libro";
    const port=makePort(libro.portada);
    b.append(lab,fr,port);
    b.onclick=()=>{if(i<3){lab.style.display="none";fr.style.display="flex";}else{b.innerHTML="";b.append(port);}};
    grid.append(b);
  }
}
/* TRY FETCH ---------------------------------------------------- */
(async()=>{
  try{
    const r=await fetch("https://raw.githubusercontent.com/badirnakid/triggui-content/main/contenido.json");
    if(!r.ok) throw new Error(r.statusText);
    const data=await r.json();
    if(!data.libros||!data.libros.length) throw new Error("contenido.json vacío");
    libro=data.libros[Math.floor(Math.random()*data.libros.length)];
  }catch(e){
    errBox.textContent="⚠ "+e.message+" — usando demo";
    errBox.style.display="block";
    libro=dummy;
  }
  render();
})();
</script>
</body>
</html>
